<div class="main-banner">
  <h1 class="text-white text-center mt-5">Poutine Podium</h1>
  <p class="text-white text-center">Le site des connaisseurs de poutine.</p>
  <form class="form-inline d-flex justify-content-center">
    <input type="text" class="form-control w-50">
    <button type="submit" class="btn btn-main-action">Trouver une poutinerie</button>
  </form>
  <div class="d-flex align-items-center justify-content-center flex-column flex-sm-row my-4">
  </div>
</div>

<div class="container home">
  <div class="row">
    <div class="col-12 col-xl-8">
      <h2 class="text-center my-3">TOP 10 POUTINES</h2>
      <table class="table-podium table">
        <% @restaurants.take(9).each_with_index do |restaurant, i| %>
          <tr data-toggle="collapse" data-target="#collapse-<%= i %>" class="table-podium-header">
            <td class="d-none d-sm-block">
              <% if restaurant.photo.attached? %>
                <%= cl_image_tag restaurant.photo.key, class: "img-circle" %>
              <% else %>
                <%= image_tag 'https://previews.123rf.com/images/sudowoodo/sudowoodo1701/sudowoodo170100010/68834656-poutine-traditional-canadian-food-from-quebec-potato-french-fries-with-gravy-and-cheese-curds-isolat.jpg', class: "img-circle" %>
              <% end %>
            </td>
          <td>#<%= i + 1 %></td>
            <td class="w-100"><%= restaurant.name %></td>
            <td>
              <% unless restaurant.json_address.nil? %>
                <% if restaurant.json_address['data']['address']['city'].nil? %>
                  <%= restaurant.json_address['data']['address']['municipality'] %>
                <% else %>
                  <%= restaurant.json_address['data']['address']['city'] %>
                <% end %>
              <% end %>
            </td>
            <td>94%</td>
          </tr>
          <tr class="table-podium-body">
            <td colspan="12">
              <div class="collapse" id="collapse-<%= i %>">
                <div class="p-2">
                  <div>Cat√©gorie: <%= restaurant.restaurant_category.name %></div>
                  <div>Prix de la poutine classique: <%= restaurant.poutine_price %> $ (avant taxes)</div>
                  <div>Addresse: <%= restaurant.address %></div>

                  <div class="container-fluid my-3">
                    <div id="carousel-example-<%= i %>" class="carousel carousel-<%= i %> slide" data-interval="false" data-ride="carousel-example-<%= i %>">

                      <div class="carousel-inner c-<%= i %> row w-100 mx-auto" role="listbox">
                        <% restaurant.reviews.map{ |r| r.photos }.flatten.each_with_index do |photo, j| %>
                          <div class="carousel-item ci-<%= i %> col-12 col-sm-6 col-md-4 <%= 'active' if j == 0 %>">
                            <%= cl_image_tag photo.key, height: 160, width: 240, crop: :fill, class: "img-fluid mx-auto d-block carousel-img" %>
                          </div>
                        <% end %>
                      </div>

                      <a class="carousel-control-prev" href="#carousel-example-<%= i %>" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                      </a>
                      <a class="carousel-control-next" href="#carousel-example-<%= i %>" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                      </a>
                    </div>
                    <%= link_to 'Voir le restaurant', restaurant_path(restaurant), class: "btn btn-main-action my-4" %>
                  </div>
                </div>
              </div>
            </td>
          </tr>
        <% end %>
      </table>
    </div>
    <div class="col-12 col-xl-4 border p-5 mt-4 h-100">
      <h2>Latest reviews / Battle of the poutines / etc.</h2>
      <p>Community stuff</p>
    </div>
  </div>
</div>




